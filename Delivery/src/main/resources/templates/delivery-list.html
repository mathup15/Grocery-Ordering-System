<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Delivery List</title>
    <style>
        body { font-family: Arial, sans-serif; background:#f4fff6; margin:20px; }
        h1 { color:#2e7d32; text-align:center; }
        .container { max-width: 1100px; margin: 0 auto; }
        .message { text-align:center; margin:10px 0; font-weight:bold; }
        .message.success { color: green; }
        .message.error { color: darkred; }

        .assignment-card {
            background:#fff;
            border-radius:10px;
            box-shadow:0 2px 8px rgba(0,0,0,0.08);
            margin-bottom:14px;
            overflow:hidden;
        }
        .assignment-table { width:100%; border-collapse:collapse; }
        .assignment-table th {
            background:#2e7d32; color:#fff; text-align:left; padding:10px; width:200px;
        }
        .assignment-table td { padding:10px; border-bottom:1px solid #e6efe6; }
        .action-links a { margin-right:8px; color:#2e7d32; text-decoration:none; font-weight:600; }
        .empty { text-align:center; color:#666; padding:20px; }

        .back { display:block; text-align:center; margin:18px 0; color:#2e7d32; text-decoration:none; }
    </style>
</head>
<body>
<div class="container">
    <h1>Delivery Assignments</h1>

    <div th:if="${message}" class="message success" th:text="${message}"></div>
    <div th:if="${error}" class="message error" th:text="${error}"></div>

    <!-- If deliveries list is empty -->
    <div th:if="${#lists.isEmpty(deliveries)}" class="empty">
        No deliveries found.
    </div>

    <!-- Iterate assignments -->
    <div th:each="assignment : ${deliveries}" class="assignment-card">
        <table class="assignment-table">
            <tr>
                <th>Assignment ID</th>
                <td th:text="${assignment.id}">-</td>
            </tr>

            <tr>
                <th>Order ID</th>
                <td th:text="${assignment.order != null ? assignment.order.id : 'N/A'}">-</td>
            </tr>

            <tr>
                <th>Customer Name</th>
                <td th:text="${(assignment.order != null and assignment.order.customer != null) ? assignment.order.customer.name : 'N/A'}">-</td>
            </tr>

            <tr>
                <th>Customer Number</th>
                <td th:text="${(assignment.order != null and assignment.order.customer != null) ? assignment.order.customer.phoneNumber : (assignment.order != null ? assignment.order.contactInfo : 'N/A')}">-</td>
            </tr>

            <tr>
                <th>Driver</th>
                <td th:text="${assignment.driver != null ? assignment.driver.name : 'Unassigned'}">-</td>
            </tr>

            <tr>
                <th>Status</th>
                <td th:text="${assignment.status}">-</td>
            </tr>

            <tr>
                <th>Actions</th>
                <td class="action-links">
                    <a th:href="@{/delivery/update-status/{id}(id=${assignment.id})}">Update Status</a>
                    <a th:if="${assignment.order != null}" th:href="@{/delivery/track/{orderId}(orderId=${assignment.order.id})}">Track</a>
                </td>
            </tr>
        </table>
    </div>

    <a class="back" href="/delivery">Back to Assign Page</a>
</div>
</body>
</html>
